from telegram import Update
from telegram.ext import ContextTypes
from db import create_or_get_user
from handlers.utils import build_main_menu


async def start_handler(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """–û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /start ‚Äî —Å—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ –ø–æ–∫–∞–∑—É—î –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é."""
    user_id = update.effective_user.id
    user = create_or_get_user(user_id)

    greeting_text = (
        "üëã <b>–ü—Ä–∏–≤—ñ—Ç!</b> –¶–µ –±–æ—Ç –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–æ <b>–ù–ú–¢ –∑ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏</b> üìê\n\n"
        "üìå <b>–Ø–∫ –ø—Ä–∞—Ü—é—î –±–æ—Ç:</b>\n"
        "‚Ä¢ –û–±–∏—Ä–∞—î—à —Ç–µ–º—É —ñ —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ\n"
        "‚Ä¢ –û—Ç—Ä–∏–º—É—î—à –∑–∞–¥–∞—á—ñ –π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î—à –Ω–∞ –Ω–∏—Ö\n"
        "‚Ä¢ –ù–∞–∫–æ–ø–∏—á—É—î—à –±–∞–ª–∏ –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n\n"
        "üèÜ <b>–Ø–∫ –Ω–∞—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –±–∞–ª–∏ (V2):</b>\n"
        "‚Ä¢ <b>+1 –±–∞–ª</b> –∑–∞ '–¢–µ—Å—Ç (1 –≤—ñ–¥–ø–æ–≤—ñ–¥—å)'\n"
        "‚Ä¢ <b>+1 –±–∞–ª</b> –∑–∞ –∫–æ–∂–Ω—É –ø—Ä–∞–≤–∏–ª—å–Ω—É —É '–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ' (–º–∞–∫—Å. 3)\n"
        "‚Ä¢ <b>+2 –±–∞–ª–∏</b> –∑–∞ '–í—ñ–¥–∫—Ä–∏—Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å'\n"
        "‚Ä¢ <b>+10 –±–∞–ª—ñ–≤</b> –∑–∞ 'BOSS/¬´–≥—Ä–æ–±–∏–∫¬ª'\n"
        "‚Ä¢ –ü–µ—Ä–µ–≥–ª—è–¥–∞–π —Å–≤—ñ–π –ø—Ä–æ–≥—Ä–µ—Å —É <b>üìä –ú—ñ–π –ø—Ä–æ–≥—Ä–µ—Å</b>\n\n"
        "üìö <b>–ù–∞–≤—á–∞–ª—å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏:</b>\n"
        "‚Ä¢ –ü—ñ–¥—Ä—É—á–Ω–∏–∫–∏, –¥–æ–≤—ñ–¥–Ω–∏–∫–∏ —Ç–∞ –≤—ñ–¥–µ–æ ‚Äî —É —Ä–æ–∑–¥—ñ–ª—ñ <b>–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏</b>\n\n"
        "üéØ <b>–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:</b>\n"
        "1Ô∏è‚É£ –û–±–µ—Ä–∏ —Ç–µ–º—É üìö —Ç–∞ —Ä—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ üéØ\n"
        "2Ô∏è‚É£ –û—Ç—Ä–∏–º–∞–π –∑–∞–¥–∞—á—É üß† –∞–±–æ —â–æ–¥–µ–Ω–Ω—É –∑–∞–¥–∞—á—É üîÅ\n"
        "3Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä —Å–≤—ñ–π –ø—Ä–æ–≥—Ä–µ—Å —ñ –∑–∞—Ä–æ–±–ª—è–π –±–µ–π–¥–∂—ñ üèÖ\n\n"
        "üìç <b>–ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é:</b>"
    )

    await update.message.reply_text(
        greeting_text,
        parse_mode="HTML",
        reply_markup=build_main_menu(user_id)
    )
